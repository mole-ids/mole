


<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="MOLE IDS Documentation">
      
      
      
        <meta name="author" content="mole-ids.org">
      
      <link rel="shortcut icon" href="../../assets/img/mole.icon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-5.5.7">
    
    
      
        <title>Configuration Introduction - MOLE IDS</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.b8ac9624.min.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/palette.28f3ef9a.min.css">
      
      
        
        
        <meta name="theme-color" content="#03a9f4">
      
    
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
      <link rel="stylesheet" href="../../assets/styles/extra.css">
    
      <link rel="stylesheet" href="../../assets/styles/atom-one-light.css">
    
    
      
    
    
  </head>
  
  
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="light-blue" data-md-color-accent="light-blue">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#configuration-introduction" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="../.." title="MOLE IDS" class="md-header-nav__button md-logo" aria-label="MOLE IDS">
      
  <img src="../../assets/img/mole.logo.png" alt="logo">

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            MOLE IDS
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              Configuration Introduction
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/mole-ids/mole/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
        
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="MOLE IDS" class="md-nav__button md-logo" aria-label="MOLE IDS">
      
  <img src="../../assets/img/mole.logo.png" alt="logo">

    </a>
    MOLE IDS
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/mole-ids/mole/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Welcome" class="md-nav__link">
      Welcome
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" checked>
    
    <label class="md-nav__link" for="nav-2">
      Getting Started
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Getting Started" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        Getting Started
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../concepts/" title="Concepts" class="md-nav__link">
      Concepts
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../quick-start/" title="Quick Start" class="md-nav__link">
      Quick Start
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../getting-mole/" title="Getting Mole" class="md-nav__link">
      Getting Mole
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Configuration Introduction
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 9h14V7H3v2m0 4h14v-2H3v2m0 4h14v-2H3v2m16 0h2v-2h-2v2m0-10v2h2V7h-2m0 6h2v-2h-2v2z"/></svg>
        </span>
      </label>
    
    <a href="./" title="Configuration Introduction" class="md-nav__link md-nav__link--active">
      Configuration Introduction
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#interface" class="md-nav__link">
    Interface
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#engine" class="md-nav__link">
    engine
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rules" class="md-nav__link">
    rules
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#logger" class="md-nav__link">
    logger
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#full-example" class="md-nav__link">
    Full example
  </a>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../writing-rules/" title="Writing rules" class="md-nav__link">
      Writing rules
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../mole-commands/" title="Mole IDS Commands" class="md-nav__link">
      Mole IDS Commands
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Mole development
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Mole development" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        Mole development
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../mole-devel/compiling/" title="Compiling" class="md-nav__link">
      Compiling
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../mole-devel/development/" title="Development" class="md-nav__link">
      Development
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#interface" class="md-nav__link">
    Interface
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#engine" class="md-nav__link">
    engine
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rules" class="md-nav__link">
    rules
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#logger" class="md-nav__link">
    logger
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#full-example" class="md-nav__link">
    Full example
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/mole-ids/mole/edit/master/docs/content/getting-started/configuration-overview.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                  
                
                
                <h1 id="configuration-introduction">Configuration Introduction<a class="headerlink" href="#configuration-introduction" title="Permanent link">&para;</a></h1>
<p class="subtitle">How the Magic Happens</p>
<p>Mole IDS can be configured issuing arguments when you execute Mole IDS form the
command line. But, you can also use a configuration file, which will make your
life a little bit easy.</p>
<p>Mole IDS uses a <code>YAML</code> file to define its options and it is called <code>mole.yml</code>.
<code>mole.yml</code> can be placed next to the Mole IDS binary or in <code>/etc/mole/mole.yml</code>.
Although, you can also define the <code>mole.yml</code> location using the command line
flag <code>--config &lt;path&gt;</code>.</p>
<div class="admonition example">
<p class="admonition-title">Mole IDS configuration falg</p>
<pre class="highlight"><code class="language-shell">./mole --config &lt;path_to_mole.yml&gt; ids --iface ens33</code></pre>

</div>
<p>At the moment the configuration file is splited up in four sections:</p>
<ul>
<li>interface: Configuration related to the interface.</li>
<li>engine: Configuration related to the engine.</li>
<li>rules: Rules related options.</li>
<li>logger: logger configurations.</li>
</ul>
<h2 id="interface">Interface<a class="headerlink" href="#interface" title="Permanent link">&para;</a></h2>
<p>The interface section indicates which interface will be used by Mole IDS, if the
want to use PF_RING features or you can define a BPF filter.</p>
<pre class="highlight"><code class="language-yaml">interface:
    iface: ens33
    pf_ring: true
    bpf: udp and dst port not 53</code></pre>

<p>On the previous example Mole will listen traffic from the <code>ens33</code> interface.
PF_RING will be used as capturing driver and only the traffic defined in the
<code>bpf</code> filter will be captured.</p>
<p>When setting <code>interface.pf_ring</code> to <code>false</code> Mole IDS will use libpcap to capture
packages from the interface.</p>
<p>If Mole IDS was compiled without PF_Ring support and you configure it to use
the PF_Ring driver, Mole IDS will fall down to libpcap.</p>
<h2 id="engine">engine<a class="headerlink" href="#engine" title="Permanent link">&para;</a></h2>
<p>The engine sections has no options at the moment, this section is defined for
future purposes.</p>
<h2 id="rules">rules<a class="headerlink" href="#rules" title="Permanent link">&para;</a></h2>
<p>This section defines where and how the Yara rules should be loaded. In this secction
we defined two entry for loading the rules, one for loading them from a directory
so Mole IDS will load all <code>*.yar</code> files in that folder without recursion. Second,
you can provide a Yara rules index file and Mole will load those rules. Moreover,
there is a section for the user to define a set of variables. Those variables can
be used later on in the rules.</p>
<pre class="highlight"><code class="language-yaml">rules:
    rules_dir: ./rules
    rules_index: ./index.yar
    variables:
      $HOME_NET: "10.0.0.0/8"</code></pre>

<p>If you are wondering yourself how to use the variables, I'll show you down below,
but if you want to know more about rules, pleae go to
<a href="/writing-rules/">writing rules</a> section.</p>
<pre class="highlight"><code class="language-yara">rule ExampleRule {
    meta:
        type = "alert"
        proto = "tcp"
        src = "$HOME_NET"
        sport = "any"
        dst = "any"
        sport = "80"

    strings:
        $host = "google.com"

    condition:
        $host
}</code></pre>

<h2 id="logger">logger<a class="headerlink" href="#logger" title="Permanent link">&para;</a></h2>
<p>Finally, we defined a logging section. This section defines two types of logger,
the first one is for Mole IDS where Mole IDS will log all the internal messages,
on the other hand, the sencod type of log is for the Mole IDS users. That log will
contain a <code>JSON</code> object with the matching alert information.</p>
<pre class="highlight"><code class="language-yaml">logger:
    log_to: /dev/stdout
    log_level: "info"

    mole:
      format: eve
      to: /var/log/mole/alert.json</code></pre>

<p><code>log_to</code> and <code>log_level</code> indicates to Mole IDS where and in which level should log
the internal stuff. On th other hand, there is a <code>mole</code> entry where the alert logs
are defined. <code>mole.format</code> is used to output the alerts in different formats and
<code>mole.to</code> indicates where Mole IDS will write the alerts.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>At the moment there is one unique format avaliable, which is <code>eve</code>. That format
writes the logs in <code>JSON</code> format, but the content of the logs mimics the
<code>eve.json</code> format from <a href="https://suricata-ids.org/">Suticata IDS</a>.</p>
</div>
<p>Following there is an example of an alert output.</p>
<pre class="highlight"><code class="language-json">{
  "level": "info",
  "ts": 1594760683.2996953,
  "msg": "mole",
  "mole_event": {
    "timestamp": "2020-07-14T23:04:42.919469+0200",
    "event_type": "alert",
    "in_iface": "ens33",
    "src_ip": "172.16.150.208/32",
    "src_port": 6009,
    "dst_ip": "216.58.211.46/32",
    "dst_port": 80,
    "proto": "tcp",
    "alert": {
      "name": "HTTPGetGoogle",
      "id": "",
      "tags": [
        "tcp",
        "http"
      ],
      "meta": {
        "description": "Detect http get method to google.com",
        "type": "alert",
        "proto": "tcp",
        "src": "172.16.0.0/16",
        "sport": "0:65535",
        "dst": "0.0.0.0/0",
        "dport": "80"
      }
    },
    "matches": [
      {
        "name": "$method",
        "data": "R0VU",
        "base": 0,
        "offset": 0
      },
      {
        "name": "$host",
        "data": "Z29vZ2xlLmNvbQ==",
        "base": 0,
        "offset": 22
      }
    ]
  }
}</code></pre>

<h2 id="full-example">Full example<a class="headerlink" href="#full-example" title="Permanent link">&para;</a></h2>
<pre class="highlight"><code class="language-yaml">interface:
    iface: ens33
    pf_ring: true
    bpf: udp and dst port not 53

engine:

rules:
    rules_dir: ./rules
    rules_index: ./index.yar
    variables:
      $HOME_NET: "10.0.0.0/8"

logger:
    log_to: /dev/stdout
    log_level: "info"

    mole:
      format: eve
      to: /var/log/mole/alert.json</code></pre>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      



<!-- Application footer -->
<footer class="md-footer">

    <!-- Further information -->
    <div class="md-footer-meta md-typeset">
        <div class="md-footer-meta__inner md-grid">

            <!-- Copyright and theme information -->
            <div class="md-footer-copyright">
                
                <div class="md-footer-copyright__highlight">
                    Copyright &copy; 2020 Mole-IDS
                </div>
                
                powered by
                <a href="https://www.mkdocs.org" title="MkDocs">MkDocs</a>
                and
                <a href="https://squidfunk.github.io/mkdocs-material/"
                   title="Material for MkDocs">
                    Material for MkDocs</a>
            </div>

            <!-- Social links -->
            
            
            
        </div>
    </div>
</footer>


    </div>
    
      <script src="../../assets/javascripts/vendor.d1f5a259.min.js"></script>
      <script src="../../assets/javascripts/bundle.d5fec882.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script>
      
      <script>
        app = initialize({
          base: "../..",
          features: [],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.fae956e7.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
        <script src="../../assets/js/hljs/highlight.pack.js"></script>
      
        <script src="../../assets/js/extra.js"></script>
      
        <script src="../../theme/js/structor-menu.js"></script>
      
    
  </body>
</html>